// private trust//

select
A.code,
A.description,
A.risk_rating,
A.CLIENT_NO_,
A.BUSINESS_ACTIVITY,
B.Client_No_,     
B.Type,           
B.Name,                 
B.Status,         
B.Admin,    
B.Manager,  
B.Direcor,  
B.Account,  
B.Client_Group,   
B.Solution_Line,
B.Client_Status
from
(select
BAT.code,
BAT.description,
BAT.risk_rating,
CAT.CLIENT_NO_,
CAT.BUSINESS_ACTIVITY
from
CLEANSING_ZONE.JER_NAVONE_DBO.CZ_JER_NAVONE_DBO__JERSEY_BUSINESS_ACTIVITY_TYPES BAT
join
CLEANSING_ZONE.JER_NAVONE_DBO.CZ_JER_NAVONE_DBO__JERSEY_CLIENT_BUS__ACTIVITY_TYPES CAT
on CAT.BUSINESS_ACTIVITY = BAT.code
where CAT.business_activity is not null) A
join
(select
JC.Client_No_,    
JC.Type,          
JC.Name,                
JC.Status,        
JC.ClientAnalysisA      as    Admin,      
JC.ClientAnalysisB      as    Manager,    
JC.ClientAnalysisC as   Direcor,    
JC.ClientAnalysisD as   Account,    
JC.ClientAnalysisE as   Client_Group,     
JC.ClientAnalysisF as Solution_Line,
CASE
When Status = 0 THEN 'Prospective'
When Status = 1 THEN 'Live'
When Status = 2 THEN 'Terminal'
When Status = 3 THEN 'Closed'
ELSE 'Null'
END AS Client_Status
from CLEANSING_ZONE.JER_NAVONE_DBO.CZ_JER_NAVONE_DBO__JERSEY_CLIENT JC) B
on A.CLIENT_NO_ = B.CLIENT_NO_